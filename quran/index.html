<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran App</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Scheherazade:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        h1 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #333333;
        }
        .ayah {
            margin-bottom: 20px;
            border-bottom: 1px solid #ced4da;
            padding-bottom: 20px;
        }

        .ayah-number {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }

        .ayah-text {
            margin-top: 5px;
        }

        .arabic-text {
            font-family: "Scheherazade", Arial, sans-serif; /* Use Scheherazade font for Arabic text */
            font-size: 36px;
            text-align: right; /* Align text to the right */
        }

        .indonesian-text {
            font-family: "Arial", sans-serif; /* Use appropriate font for Indonesian text */
            color: #333333;
        }

        /* Loading animation */
        .loading {
            display: none; /* Initially hidden */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loading p {
            text-align: center;
            margin-top: 10px;
            color: green;
        }

        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #ffffff;
            padding: 10px -10;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
            font-size: 10px;
        }
    </style>
</head>
<body>

    <div class="loading">
        <div class="loading-spinner"></div>
        <p>Loading the Quran Data...</p>
    </div>

    <div class="container">
        <h1 class="text-center">Quran App</h1>
        
        <form id="quran-form">
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="surah">Select Surah:</label>
                    <select class="form-control" name="surah" id="surah">
                        <option value="">Select Surah</option>
                    </select>
                </div>

                <div class="form-group col-md-6">
                    <label for="juz">Select Juz:</label>
                    <select class="form-control" name="juz" id="juz">
                        <option value="">Select Juz</option>
                        <!-- Juz options will be populated via JavaScript -->
                    </select>
                </div>
            </div>
        </form>

        <div class="content" id="content"></div>

        <div class="footer">
            <p>&copy; 2023-<?php echo date("Y"); ?> Quran App by <a href="https://primaginary.my.id/" target="_blank">Primaginary Learning</a> Platform, M. Alfa Ridzi, S. Mat</p>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Populate Juz options
            const juzSelect = document.getElementById('juz');
            for (let j = 1; j <= 30; j++) {
                const option = document.createElement('option');
                option.value = j;
                option.textContent = `Juz ${j}`;
                juzSelect.appendChild(option);
            }

            // Fetch Surah data
            fetch('https://equran.id/api/v2/surat')
                .then(response => response.json())
                .then(data => {
                    const surahSelect = document.getElementById('surah');
                    data.data.forEach(surah => {
                        const option = document.createElement('option');
                        option.value = surah.nomor;
                        option.textContent = `${surah.nama} (${surah.namaLatin})`;
                        surahSelect.appendChild(option);
                    });
                });

            // Add event listeners for select changes
            document.getElementById('surah').addEventListener('change', handleSelectChange);
            document.getElementById('juz').addEventListener('change', handleSelectChange);
        });

        function handleSelectChange() {
            const surahSelect = document.getElementById('surah');
            const juzSelect = document.getElementById('juz');
            const loadingText = document.querySelector('.loading p');

            if (surahSelect.value) {
                loadingText.textContent = `Loading the Quran Data for Surah: ${surahSelect.options[surahSelect.selectedIndex].text}`;
            } else if (juzSelect.value) {
                loadingText.textContent = `Loading the Quran Data for Juz: ${juzSelect.options[juzSelect.selectedIndex].text}`;
            } else {
                return;
            }

            document.querySelector('.loading').style.display = 'flex';
            fetchData();
        }

        function fetchData() {
            const surahSelect = document.getElementById('surah');
            const juzSelect = document.getElementById('juz');
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = ''; // Clear previous content

            let apiUrl = '';

            if (surahSelect.value) {
                apiUrl = `https://equran.id/api/v2/surat/${surahSelect.value}`;
            } else if (juzSelect.value) {
                const juzNumber = juzSelect.value;
                const juzApiUrlArabic = `https://api.alquran.cloud/v1/juz/${juzNumber}/quran-simple`;
                const juzApiUrlTranslate = `https://api.alquran.cloud/v1/juz/${juzNumber}/id.indonesian`;

                Promise.all([
                    fetch(juzApiUrlArabic),
                    fetch(juzApiUrlTranslate)
                ])
                .then(responses => Promise.all(responses.map(response => response.json())))
                .then(([arabicData, translateData]) => {
                    const juzArabic = arabicData.data;
                    const juzTranslate = translateData.data;

                    contentDiv.innerHTML += `<h2>Juz ${juzArabic.number}</h2>`;
                    juzArabic.ayahs.forEach((ayahArabic, index) => {
                        const ayahTranslate = juzTranslate.ayahs[index];
                        contentDiv.innerHTML += `
                            <div class="ayah">
                                <p class="ayah-number"><strong>Ayat ${ayahArabic.numberInSurah}</strong></p>
                                <p class="ayah-text arabic-text">${ayahArabic.text}</p>
                                <p class="ayah-text indonesian-text">${ayahTranslate.text}</p>
                            </div>`;
                    });
                })
                .catch(err => console.error(err))
                .finally(() => {
                    document.querySelector('.loading').style.display = 'none'; // Hide loading
                });
                return;
            }

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const surah = data.data;
                    contentDiv.innerHTML += `<h2>${surah.nama} (${surah.namaLatin})</h2><p>${surah.deskripsi}</p>`;
                    surah.ayat.forEach(ayah => {
                        contentDiv.innerHTML += `
                            <div class="ayah">
                                <p class="ayah-number"><strong>Ayat ${ayah.nomorAyat}:</strong></p>
                                <p class="ayah-text arabic-text">${ayah.teksArab}</p>
                                <p class="ayah-text indonesian-text">${ayah.teksIndonesia}</p>
                            </div>`;
                    });
                })
                .catch(err => console.error(err))
                .finally(() => {
                    document.querySelector('.loading').style.display = 'none'; // Hide loading
                });
        }
    </script>

</body>
</html>
